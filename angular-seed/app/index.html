<!DOCTYPE html>
<!--[if lt IE 7]>      <html lang="en" ng-app="myApp" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html lang="en" ng-app="myApp" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html lang="en" ng-app="myApp" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en" ng-app="myApp" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>My AngularJS App</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="bower_components/html5-boilerplate/dist/css/normalize.css">
  <link rel="stylesheet" href="bower_components/html5-boilerplate/dist/css/main.css">
  <link rel="stylesheet" href="app.css">
  <link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.5/leaflet.css" />
  <script src="http://cdn.leafletjs.com/leaflet-0.7.5/leaflet.js"></script>
  <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
  <script src="bower_components/html5-boilerplate/dist/js/vendor/modernizr-2.8.3.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script type="text/javascript" src="../../maps/ne_110m_admin_0_boundary_lines_land/subunits.json"></script>
	<script type="text/javascript">
			d3.json("../data/countries_2013.json", function(error, countries2013) {
				// setup the map
				var map = L.map('map').setView([51.505, -0.09], 3);

				L.tileLayer('https://api.tiles.mapbox.com/v4/rdeprey.nnkh2lia/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoicmRlcHJleSIsImEiOiJjaWZ1ZTYwMjUxdnA5dGZtMTBiYTAzaGZrIn0.Ke3x2K5bOHdEOXYz2rwa-A', {
		    		attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
				    maxZoom: 18,
				    id: 'rdeprey.nnkh2lia',
				    accessToken: 'pk.eyJ1IjoicmRlcHJleSIsImEiOiJjaWZ1ZTYwMjUxdnA5dGZtMTBiYTAzaGZrIn0.Ke3x2K5bOHdEOXYz2rwa-A'
				}).addTo(map);

				L.geoJson(countries2013).addTo(map);

				function getColor(countries2013) {
					for (var item in countries2013) {
						return countries2013[item].Advancement_Level == 'Significant Advancement' ? '#ABDDA4' : 
							   countries2013[item].Advancement_Level == 'Moderate Advancement' ? '#c8dda4' : 
							   								 '#cccccc';
					}
				}

				function highlightFeature(e) {
					var layer = e.target;

					layer.setStyle({
						weight: 5,
						color: '#666',
						dashArray: '',
						fillOpacity: 0.7
					});

					if (!L.Browser.ie && !L.Browser.opera) {
						layer.bringToFront();
					}
				}

				function resetHighlight(e) {
					geojson.resetStyle(e.target);
				}

				function zoomToFeature(e) {
					map.fitBounds(e.target.getBounds);
				}

				function style(feature) {
					return {
						fillColor: getColor(countries2013),
						weight:2,
						opacity: 1,
						color: 'white',
						dashArray: '1',
						fillOpacity: 0.7
					};
				}

				L.geoJson(countries2013, {style: style}).addTo(map);

				function onEachFeature(feature, layer) {
					layer.on({
						mouseover: highlightFeature,
						mouseout: resetHighlight,
						click: zoomToFeature
					});
				}

				var geojson;
				geojson = L.geoJson(boundaries, {
					style:style,
					onEachFeature: onEachFeature
				}).addTo(map);



				// Associate the fill colors with each ISO3 code
				// var fullData;
				// var getFillKeys = function(countries2013) {
				// 	fullData = countries2013;

				// 	for (var item in fullData) {
				// 		var country = countries2013[item].ISO3;

				// 		fullData[country] = {};
				// 		fullData[country].fillKey = countries2013[item].Advancement_Level;
				// 	}
				// };
				// getFillKeys(countries2013);


			});

	</script>
</head>
<body>
  <ul class="menu">
    <li><a href="#/view1">view1</a></li>
    <li><a href="#/view2">view2</a></li>
  </ul>

  <!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
  <![endif]-->

  <div ng-view></div>

<header>
		<h1>Visualizing Forced Labor and Child Labor</h1> <!-- Working title -->
	</header>
	<div id="map" style="height:890px;">
		
	</div>
	<footer>
		<p><small>Data from the <a href="http://www.dol.gov">Department of Labor's</a> <a href="http://www.dol.gov/ilab/">Bureau of International Labor Affairs (ILAB)</a>    <a href="../data/countries2013.json">Download This Data</a><small></p>
	</footer>


  <!-- In production use:
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/x.x.x/angular.min.js"></script>
  -->
  <script src="bower_components/angular/angular.js"></script>
  <script src="bower_components/angular-route/angular-route.js"></script>
  <script src="app.js"></script>
  <script src="view1/view1.js"></script>
  <script src="view2/view2.js"></script>
  <script src="components/version/version.js"></script>
  <script src="components/version/version-directive.js"></script>
  <script src="components/version/interpolate-filter.js"></script>
</body>
</html>
